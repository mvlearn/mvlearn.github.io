

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Co-training performance in various simulated scenarios &mdash; mvlearn alpha documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reference" href="../../references/index.html" />
    <link rel="prev" title="2-View Semi-Supervised Classification" href="plot_cotraining_classification.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/mvlearn-logo-transparent-white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using mvlearn</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#installing-the-released-version-with-pip">Installing the released version with pip</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../install.html#including-optional-torch-dependencies-for-full-functionality">Including optional torch dependencies for full functionality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#installing-the-released-version-with-conda-forge">Installing the released version with conda-forge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#python-package-dependencies">Python package dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#hardware-requirements">Hardware requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#os-requirements">OS Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-on-cluster">Examples on cluster</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_coregularized_spectral_tutorial.html">Multiview Clustering Algorithm to Cluster Data with Multiple Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_spherical_kmeans_tutorial.html">Multiview Spherical KMeans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_kmeans_tutorial.html">Multiview KMeans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_kmeans_validation_simulated.html">Multiview vs. Singleview KMeans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_spectral_tutorial.html">Multiview Spectral Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/mv_spherical_validation_simulated.html">Multiview vs. singlview Spherical KMeans performance vs. class separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/mv_spherical_kmeans_validation_paper.html">Multiview Spherical KMeans on the Newsgroup dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_spectral_validation_simulated.html">Multiview vs. singleview Spectral Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_vs_singleview_spectral.html">Multiview vs. Singleview Spectral Clustering of the UCI data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_spectral_validation_complex.html">Assessing the Conditionally independence views requirement of Multiview Spectral Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster/plot_mv_kmeans_validation_complex.html">Assessing the conditionally independence views requirement of Multiview KMeans</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-on-datasets">Examples on datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/plot_load_ucimultifeature.html">Loading and Viewing the UCI Multiple Features Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasets/plot_gaussianmixtures.html">Data from Gaussian Mixtures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-on-decomposition">Examples on decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../decomposition/plot_mv_ica_tutorial.html">Independent Component Analysis (ICA) Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../decomposition/plot_group_ica_tutorial.html">ICA: a tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../decomposition/plot_ajive_tutorial.html">Angle-based Joint and Individual Variation Explained  (AJIVE)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-on-embed">Examples on embed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_gcca_tutorial.html">Generalized Canonical Correlation Analysis (GCCA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_dcca_tutorial.html">Deep CCA (DCCA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_omnibus_embedding.html">Omnbius Graph embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_mvmds_tutorial.html">Multidimensional Scaling (MVMDS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_cca_comparison.html">Comparing CCA Variants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_kcca_tutorial.html">Kernel CCA (KCCA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/plot_kcca_icd_tutorial.html">Incomplete Cholesky Decomposition (ICA) for CCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embed/splitae_tutorial.html">SplitAE embeddings on multiview MNIST data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-on-pipeline">Examples on pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pipeline/plot_pipeline_sklearn_integration.html">Integrating mvlearn with scikit-learn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#examples-on-plotting">Examples on plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plotting/plot_quick_visualize_tutorial.html">Exploratory visualizations using quick_visualize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plotting/plot_crossviews_plot.html">Plotting multiview data with crossplot</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#examples-on-semi-supervised">Examples on semi_supervised</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_cotraining_regression.html">2-View Semi-Supervised Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_cotraining_classification.html">2-View Semi-Supervised Classification</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Co-training performance in various simulated scenarios</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../references/cluster.html">Clustering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/cluster.html#multiview-spectral-clustering">Multiview Spectral Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/cluster.html#co-regularized-multiview-spectral-clustering">Co-Regularized Multiview Spectral Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/cluster.html#multiview-k-means">Multiview K Means</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/cluster.html#multiview-spherical-k-means">Multiview Spherical K Means</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/semi_supervised.html">Semi-Supervised</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/semi_supervised.html#cotraining-classifier">Cotraining Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/semi_supervised.html#cotraining-regressor">Cotraining Regressor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/embed.html">Embedding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#generalized-canonical-correlation-analysis">Generalized Canonical Correlation Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#kernel-canonical-correlation-analysis">Kernel Canonical Correlation Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#deep-canonical-correlation-analysis">Deep Canonical Correlation Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#omnibus-embedding">Omnibus Embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#multiview-multidimensional-scaling">Multiview Multidimensional Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#split-autoencoder">Split Autoencoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#dcca-utilities">DCCA Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/embed.html#dimension-selection">Dimension Selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/decomposition.html">Decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/decomposition.html#multiview-ica">Multiview ICA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/decomposition.html#permutation-ica">Permutation ICA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/decomposition.html#group-ica">Group ICA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/decomposition.html#group-pca">Group PCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/decomposition.html#angle-based-joint-and-individual-variation-explained-ajive">Angle-Based Joint and Individual Variation Explained (AJIVE)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/construct.html">View Construction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/construct.html#random-gaussian-projection">Random Gaussian Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/construct.html#random-subspace-method">Random Subspace Method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/model_selection.html">Model Selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/model_selection.html#cross-validation">Cross Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/compose.html">Compose</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/compose.html#averagemerger">AverageMerger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/compose.html#concatmerger">ConcatMerger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/compose.html#simplesplitter">SimpleSplitter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/preprocessing.html">Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/preprocessing.html#viewtransformer">ViewTransformer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/datasets.html">Multiview Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/datasets.html#uci-multiple-feature-dataset-located-here">UCI multiple feature dataset (located here)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/datasets.html#data-simulator">Data Simulator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/plotting.html">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/plotting.html#quick-visualize">Quick Visualize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../references/plotting.html#crossviews-plot">Crossviews Plot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../references/utils.html">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../references/utils.html#io">IO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to mvlearn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#submitting-a-bug-report-or-a-feature-request">Submitting a bug report or a feature request</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#how-to-make-a-good-bug-report">How to make a good bug report</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#contributing-code">Contributing Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#pull-request-checklist">Pull Request Checklist</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#guidelines">Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#coding-guidelines">Coding Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#docstring-guidelines">Docstring Guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#api-of-mvlearn-objects">API of mvlearn Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#estimators">Estimators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing.html#additional-functionality">Additional Functionality</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-0-4-0">Version 0.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id1">mvlearn.compose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id4">mvlearn.decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id6">mvlearn.model_selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../changelog.html#id9">mvlearn.preprocessing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-0-3-0">Version 0.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#patch-0-2-1">Patch 0.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-0-2-0">Version 0.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#version-0-1-0">Version 0.1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mvlearn/mvlearn">mvlearn &#64; GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/mvlearn/">mvlearn &#64; PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mvlearn/mvlearn/issues">Issue Tracker</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">mvlearn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples Gallery</a> &raquo;</li>
        
      <li>Co-training performance in various simulated scenarios</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/mvlearn/mvlearn/blob/main/docs/auto_examples/semi_supervised/cotraining_classification_simulatedperformance.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-semi-supervised-cotraining-classification-simulatedperformance-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="co-training-performance-in-various-simulated-scenarios">
<span id="sphx-glr-auto-examples-semi-supervised-cotraining-classification-simulatedperformance-py"></span><h1>Co-training performance in various simulated scenarios<a class="headerlink" href="#co-training-performance-in-various-simulated-scenarios" title="Permalink to this headline">¶</a></h1>
<p>Multiview vs. singleview classifier performance:
- when one view is totally redundant
- when one view is inseparable
- when labeled data is excellent
- when labeled data is not very separable
- when data is overlapping](#Performance-when-data-is-overlapping)
- as labeled data proportion (essentially sample size) is varied</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">mvlearn.semi_supervised</span> <span class="kn">import</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a>
<span class="kn">from</span> <span class="nn">mvlearn.datasets</span> <span class="kn">import</span> <a href="../../references/datasets.html#mvlearn.datasets.load_UCImultifeature" title="mvlearn.datasets.load_UCImultifeature" class="sphx-glr-backref-module-mvlearn-datasets sphx-glr-backref-type-py-function"><span class="n">load_UCImultifeature</span></a>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
</pre></div>
</div>
<div class="section" id="function-to-create-2-class-data">
<h2>Function to create 2 class data<a class="headerlink" href="#function-to-create-2-class-data" title="Permalink to this headline">¶</a></h2>
<p>This function is used to generate examples for 2 classes from multivariate
normal distributions. Once the examples are generated, it splits them into
training and testing sets and returns the needed information</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_data</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">class2_mean_center</span><span class="p">,</span> <span class="n">view1_var</span><span class="p">,</span> <span class="n">view2_var</span><span class="p">,</span>
                <span class="n">N_per_class</span><span class="p">,</span> <span class="n">view2_class2_mean_center</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

    <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">view1_mu0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
    <span class="n">view1_mu1</span> <span class="o">=</span> <span class="n">class2_mean_center</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
    <span class="n">view1_cov</span> <span class="o">=</span> <span class="n">view1_var</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">view2_mu0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
    <span class="n">view2_mu1</span> <span class="o">=</span> <span class="n">view2_class2_mean_center</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
    <span class="n">view2_cov</span> <span class="o">=</span> <span class="n">view2_var</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">view1_class0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
        <span class="n">view1_mu0</span><span class="p">,</span> <span class="n">view1_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>
    <span class="n">view1_class1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
        <span class="n">view1_mu1</span><span class="p">,</span> <span class="n">view1_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>

    <span class="n">view2_class0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
        <span class="n">view2_mu0</span><span class="p">,</span> <span class="n">view2_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>
    <span class="n">view2_class1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
        <span class="n">view2_mu1</span><span class="p">,</span> <span class="n">view2_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>

    <span class="n">View1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">view1_class0</span><span class="p">,</span> <span class="n">view1_class1</span><span class="p">))</span>
    <span class="n">View2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">view2_class0</span><span class="p">,</span> <span class="n">view2_class1</span><span class="p">))</span>
    <span class="n">Labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">N_per_class</span><span class="p">,),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_per_class</span><span class="p">,)))</span>

    <span class="c1"># Split both views into testing and training</span>
    <span class="n">View1_train</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
        <span class="n">train_test_split</span><span class="p">(</span><span class="n">View1</span><span class="p">,</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">View2_train</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
        <span class="n">train_test_split</span><span class="p">(</span><span class="n">View2</span><span class="p">,</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="n">labels_train</span> <span class="o">=</span> <span class="n">labels_train_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">labels_test</span> <span class="o">=</span> <span class="n">labels_test_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>\
        <span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_test</span>
</pre></div>
</div>
</div>
<div class="section" id="function-to-do-predictions-on-single-or-concatenated-view-data">
<h2>Function to do predictions on single or concatenated view data<a class="headerlink" href="#function-to-do-predictions-on-single-or-concatenated-view-data" title="Permalink to this headline">¶</a></h2>
<p>This function is used create classifiers for single or concatenated views
and return their predictions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">single_view_class</span><span class="p">(</span><span class="n">v1_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">v1_test</span><span class="p">,</span> <span class="n">labels_test</span><span class="p">,</span>
                      <span class="n">v2_train</span><span class="p">,</span> <span class="n">v2_test</span><span class="p">,</span> <span class="n">v2_solver</span><span class="p">,</span> <span class="n">v2_penalty</span><span class="p">):</span>

    <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
    <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">v2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">v2_penalty</span><span class="p">)</span>
    <span class="n">gnb2</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

    <span class="c1"># Train on only the examples with labels</span>
    <span class="n">gnb0</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">v1_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">)</span>
    <span class="n">y_pred0</span> <span class="o">=</span> <span class="n">gnb0</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">v1_test</span><span class="p">)</span>

    <span class="n">gnb1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">v2_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">)</span>
    <span class="n">y_pred1</span> <span class="o">=</span> <span class="n">gnb1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">v2_test</span><span class="p">)</span>

    <span class="n">accuracy_view1</span> <span class="o">=</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred0</span><span class="p">))</span>
    <span class="n">accuracy_view2</span> <span class="o">=</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">))</span>

    <span class="c1"># Concatenate views in naive way and train model</span>
    <span class="n">combined_labeled</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack" title="numpy.hstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">((</span><span class="n">v1_train</span><span class="p">,</span> <span class="n">v2_train</span><span class="p">))</span>
    <span class="n">combined_test</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.hstack.html#numpy.hstack" title="numpy.hstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">hstack</span></a><span class="p">((</span><span class="n">v1_test</span><span class="p">,</span> <span class="n">v2_test</span><span class="p">))</span>

    <span class="n">gnb2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">combined_labeled</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">)</span>
    <span class="n">y_pred2</span> <span class="o">=</span> <span class="n">gnb2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">combined_test</span><span class="p">)</span>

    <span class="n">accuracy_combined</span> <span class="o">=</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span>
</pre></div>
</div>
</div>
<div class="section" id="function-to-create-2-class-scatter-plots-with-labeled-data-shown">
<h2>Function to create 2 class scatter plots with labeled data shown<a class="headerlink" href="#function-to-create-2-class-scatter-plots-with-labeled-data-shown" title="Permalink to this headline">¶</a></h2>
<p>This function is used to create scatter plots of the 2 class data as well as
show the samples that are labeled, making it easier to understand what
distributions the simulations are dealing with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span>
                        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">):</span>

    <span class="n">idx_train_0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train_full</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">idx_train_1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train_full</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">labeled_idx_class0</span> <span class="o">=</span> <span class="n">not_removed</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="n">labeled_idx_class1</span> <span class="o">=</span> <span class="n">not_removed</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="c1"># plot the views</span>
    <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">idx_train_0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View1_train</span><span class="p">[</span><span class="n">idx_train_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">idx_train_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View1_train</span><span class="p">[</span><span class="n">idx_train_1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">labeled_idx_class0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">View1_train</span><span class="p">[</span><span class="n">labeled_idx_class0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">labeled_idx_class1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">View1_train</span><span class="p">[</span><span class="n">labeled_idx_class1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;One Randomization of View 1&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Labeled Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Labeled Class 1&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View2_train</span><span class="p">[</span><span class="n">idx_train_0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View2_train</span><span class="p">[</span><span class="n">idx_train_0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View2_train</span><span class="p">[</span><span class="n">idx_train_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View2_train</span><span class="p">[</span><span class="n">idx_train_1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View2_train</span><span class="p">[</span><span class="n">labeled_idx_class0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">View1_train</span><span class="p">[</span><span class="n">labeled_idx_class0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View2_train</span><span class="p">[</span><span class="n">labeled_idx_class1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">View1_train</span><span class="p">[</span><span class="n">labeled_idx_class1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;One Randomization of View 2&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Labeled Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Labeled Class 1&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-on-simulated-data">
<h2>Performance on simulated data<a class="headerlink" href="#performance-on-simulated-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-experimental-setup">
<h3>General Experimental Setup<a class="headerlink" href="#general-experimental-setup" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Below are the results from simulated data testing of the cotraining
classifier with different classification problems (class distributions)</li>
<li>Results are averaged over 20 randomizations, where a single randomization
means using a new seed to generate examples from 2 class distributions and
then randomly selecting about 1% of the training data as labeled and
leaving the rest unlabeled</li>
<li>500 examples per class, with 70% used for training and 30% for testing</li>
<li><dl class="first docutils">
<dt>For a randomization, train 4 classifiers</dt>
<dd><ol class="first last arabic">
<li>Classifier trained on view 1 labeled data only</li>
<li>Classifier trained on view 2 labeled data only</li>
<li>Classifier trained on concatenation of labeled features from views 1
and 2</li>
<li><dl class="first docutils">
<dt>multivew CTClassifier trained on views 1 and 2</dt>
<dd><ul class="first last">
<li>For this, test classification accuracy after different numbers of
cotraining iterations to see trajectory of classification accuracy</li>
</ul>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Classification Method:</dt>
<dd><ul class="first last">
<li><dl class="first docutils">
<dt>Logistic Regression</dt>
<dd><ul class="first last">
<li>'l2' penalty for view 1 and 'l1' penalty for view 2 to ensure
independence between classifiers in the views. This is important
because a key aspect of cotraining is view independence, which can
either be enforced by completely independent data, or by using an
independent classifier for each view, such as using different
parameters with the same type of classifier, or two different
classification algorithms.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Performance when classes are well separated and labeled examples are randomly
chosen</p>
<p>Here, the 2 class distributions are the following
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [1, 1]
- Class 1 covariance: .2*eye(2)</p>
<p>Labeled examples are chosen randomly from the training set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomizations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_per_class</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">view2_penalty</span> <span class="o">=</span> <span class="s1">&#39;l1&#39;</span>
<span class="n">view2_solver</span> <span class="o">=</span> <span class="s1">&#39;liblinear&#39;</span>

<span class="n">N_iters</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">N_iters</span><span class="p">]</span>
<span class="n">acc_view1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_view2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_combined</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_iters</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomizations</span><span class="p">):</span>

        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span>\
            <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_test</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_per_class</span><span class="p">)</span>

        <span class="c1"># randomly remove some labels</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">),)</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">99</span>
        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># make sure both classes have at least 1 labeled example</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span>
                                <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">)</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="c1"># Only do this calculation once, as unaffected by number of iterations</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span> <span class="o">=</span> \
                <span class="n">single_view_class</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">],</span>
                                  <span class="n">View1_test</span><span class="p">,</span>
                                  <span class="n">labels_test</span><span class="p">,</span>
                                  <span class="n">View2_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">View2_test</span><span class="p">,</span>
                                  <span class="n">view2_solver</span><span class="p">,</span>
                                  <span class="n">view2_penalty</span><span class="p">)</span>
            <span class="n">acc_view1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view1</span><span class="p">)</span>
            <span class="n">acc_view2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view2</span><span class="p">)</span>
            <span class="n">acc_combined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_combined</span><span class="p">)</span>

        <span class="c1"># Multiview</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">view2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">view2_penalty</span><span class="p">)</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">(</span><span class="n">gnb0</span><span class="p">,</span> <span class="n">gnb1</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="n">iters</span><span class="p">)</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">)))</span>

<span class="n">acc_view1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view1</span><span class="p">)</span>
<span class="n">acc_view2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view2</span><span class="p">)</span>
<span class="n">acc_combined</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_combined</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">acc_ct</span><span class="p">]</span>


<span class="c1"># make a figure from the data</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view1</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_combined</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_ct</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s1">&#39;View 1&#39;</span><span class="p">,</span> <span class="s1">&#39;View 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Concatenated&#39;</span><span class="p">,</span> <span class="s1">&#39;multiview&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy Over </span><span class="si">{}</span><span class="s2"> Randomizations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randomizations</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Iterations of Co-Training&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;When Views are Independent and Labeled Samples are Random</span><span class="se">\n\</span>
<span class="s1">    CoTraining Outperforms Single Views and Naive Concatenation&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="performance-when-one-view-is-totally-redundant">
<h2>Performance when one view is totally redundant<a class="headerlink" href="#performance-when-one-view-is-totally-redundant" title="Permalink to this headline">¶</a></h2>
<p>Here, the 2 class distributions are the following
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [1, 1]
- Class 1 covariance: .2*eye(2)</p>
<p>Views 1 and 2 hold the exact same samples</p>
<p>Labeled examples are chosen randomly from the training set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomizations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_per_class</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">view2_penalty</span> <span class="o">=</span> <span class="s1">&#39;l1&#39;</span>
<span class="n">view2_solver</span> <span class="o">=</span> <span class="s1">&#39;liblinear&#39;</span>

<span class="n">N_iters</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">N_iters</span><span class="p">]</span>
<span class="n">acc_view1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_view2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_combined</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_iters</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomizations</span><span class="p">):</span>

        <span class="c1"># Create Data</span>
        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span>\
            <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_test</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_per_class</span><span class="p">)</span>
        <span class="n">View2_train</span> <span class="o">=</span> <span class="n">View1_train</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">View2_test</span> <span class="o">=</span> <span class="n">View1_test</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># randomly remove some labels</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">),)</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">99</span>
        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># make sure both classes have at least 1 labeled example</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span>
                                <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">)</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="c1"># Only do this calculation once, as unaffected by number of iterations</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span> <span class="o">=</span> \
                <span class="n">single_view_class</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">],</span>
                                  <span class="n">View1_test</span><span class="p">,</span>
                                  <span class="n">labels_test</span><span class="p">,</span>
                                  <span class="n">View2_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">View2_test</span><span class="p">,</span>
                                  <span class="n">view2_solver</span><span class="p">,</span>
                                  <span class="n">view2_penalty</span><span class="p">)</span>
            <span class="n">acc_view1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view1</span><span class="p">)</span>
            <span class="n">acc_view2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view2</span><span class="p">)</span>
            <span class="n">acc_combined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_combined</span><span class="p">)</span>

        <span class="c1"># Multiview</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">view2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">view2_penalty</span><span class="p">)</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">(</span><span class="n">gnb0</span><span class="p">,</span> <span class="n">gnb1</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="n">iters</span><span class="p">)</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">)))</span>

<span class="n">acc_view1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view1</span><span class="p">)</span>
<span class="n">acc_view2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view2</span><span class="p">)</span>
<span class="n">acc_combined</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_combined</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">acc_ct</span><span class="p">]</span>


<span class="c1"># make a figure from the data</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view1</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_combined</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_ct</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s1">&#39;View 1&#39;</span><span class="p">,</span> <span class="s1">&#39;View 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Concatenated&#39;</span><span class="p">,</span> <span class="s1">&#39;multiview&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy Over </span><span class="si">{}</span><span class="s2"> Randomizations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randomizations</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Iterations of Co-Training&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;When One View is Completely Redundant</span><span class="se">\n\</span>
<span class="s1">    CoTraining Performs Worse Than</span><span class="se">\n</span><span class="s1">Single View or View Concatenation&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-when-one-view-is-inseparable">
<h2>Performance when one view is inseparable<a class="headerlink" href="#performance-when-one-view-is-inseparable" title="Permalink to this headline">¶</a></h2>
<p>Here, the 2 class distributions are the following for the first view
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [1, 1]
- Class 1 covariance: .2*eye(2)</p>
<p>For the second view:
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [0, 0]
- Class 1 covariance: .2*eye(2)</p>
<p>Labeled examples are chosen randomly from the training set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomizations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_per_class</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">view2_penalty</span> <span class="o">=</span> <span class="s1">&#39;l1&#39;</span>
<span class="n">view2_solver</span> <span class="o">=</span> <span class="s1">&#39;liblinear&#39;</span>

<span class="n">N_iters</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">N_iters</span><span class="p">]</span>
<span class="n">acc_view1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_view2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_combined</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_iters</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomizations</span><span class="p">):</span>

        <span class="c1"># Create Data</span>
        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span>\
            <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_test</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_per_class</span><span class="p">,</span>
                                                  <span class="n">view2_class2_mean_center</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># randomly remove some labels</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">),)</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">99</span>
        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># make sure both classes have at least 1 labeled example</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span>
                                <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">)</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="c1"># Only do this calculation once, as unaffected by number of iterations</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span> <span class="o">=</span> \
                <span class="n">single_view_class</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">],</span>
                                  <span class="n">View1_test</span><span class="p">,</span>
                                  <span class="n">labels_test</span><span class="p">,</span>
                                  <span class="n">View2_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">View2_test</span><span class="p">,</span>
                                  <span class="n">view2_solver</span><span class="p">,</span>
                                  <span class="n">view2_penalty</span><span class="p">)</span>
            <span class="n">acc_view1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view1</span><span class="p">)</span>
            <span class="n">acc_view2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view2</span><span class="p">)</span>
            <span class="n">acc_combined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_combined</span><span class="p">)</span>

        <span class="c1"># Multiview</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">view2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">view2_penalty</span><span class="p">)</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">(</span><span class="n">gnb0</span><span class="p">,</span> <span class="n">gnb1</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="n">iters</span><span class="p">)</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">)))</span>

<span class="n">acc_view1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view1</span><span class="p">)</span>
<span class="n">acc_view2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view2</span><span class="p">)</span>
<span class="n">acc_combined</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_combined</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">acc_ct</span><span class="p">]</span>


<span class="c1"># make a figure from the data</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view1</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_combined</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_ct</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s1">&#39;View 1&#39;</span><span class="p">,</span> <span class="s1">&#39;View 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Concatenated&#39;</span><span class="p">,</span> <span class="s1">&#39;multiview&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy Over </span><span class="si">{}</span><span class="s2"> Randomizations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randomizations</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Iterations of Co-Training&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;When One View is Uninformative</span><span class="se">\n\</span>
<span class="s1">    CoTraining Performs Worse Than Single View&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-when-labeled-data-is-excellent">
<h2>Performance when labeled data is excellent<a class="headerlink" href="#performance-when-labeled-data-is-excellent" title="Permalink to this headline">¶</a></h2>
<p>Here, the 2 class distributions are the following
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [1, 1]
- Class 1 covariance: .2*eye(2)</p>
<p>Labeled examples are chosen to be very close to the mean of their respective
class
- Normally distributed around their class mean with standard deviation 0.05
in both dimensions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomizations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_per_class</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">num_perfect</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">perfect_scale</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">view2_penalty</span> <span class="o">=</span> <span class="s1">&#39;l1&#39;</span>
<span class="n">view2_solver</span> <span class="o">=</span> <span class="s1">&#39;liblinear&#39;</span>

<span class="n">N_iters</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">N_iters</span><span class="p">]</span>
<span class="n">acc_view1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_view2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_combined</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_iters</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomizations</span><span class="p">):</span>

        <span class="c1"># Create Data</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="n">view1_mu0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view1_mu1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view1_cov</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">view2_mu0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view2_mu1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view2_cov</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># generage perfect examples</span>
        <span class="n">perfect_class0_v1</span> <span class="o">=</span> <span class="n">view1_mu0</span> <span class="o">+</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">perfect_scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">perfect_class0_v2</span> <span class="o">=</span> <span class="n">view1_mu0</span> <span class="o">+</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">perfect_scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">perfect_class1_v1</span> <span class="o">=</span> <span class="n">view1_mu1</span> <span class="o">+</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">perfect_scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">perfect_class1_v2</span> <span class="o">=</span> <span class="n">view1_mu1</span> <span class="o">+</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">perfect_scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_perfect</span><span class="p">):</span>
            <span class="n">perfect_class0_v1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class0_v1</span><span class="p">,</span> <span class="n">view1_mu0</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span>
                    <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
            <span class="n">perfect_class0_v2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class0_v2</span><span class="p">,</span> <span class="n">view1_mu0</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span>
                    <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
            <span class="n">perfect_class1_v1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class1_v1</span><span class="p">,</span> <span class="n">view1_mu1</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span>
                    <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu1</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
            <span class="n">perfect_class1_v2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class1_v2</span><span class="p">,</span> <span class="n">view1_mu1</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span>
                    <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu1</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
        <span class="n">perfect_labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">num_perfect</span><span class="p">,)</span>
        <span class="n">perfect_labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span>
            <span class="n">perfect_labels</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">num_perfect</span><span class="p">,)))</span>

        <span class="n">view1_class0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view1_mu0</span><span class="p">,</span> <span class="n">view1_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>
        <span class="n">view1_class1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view1_mu1</span><span class="p">,</span> <span class="n">view1_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>

        <span class="n">view2_class0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view2_mu0</span><span class="p">,</span> <span class="n">view2_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>
        <span class="n">view2_class1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view2_mu1</span><span class="p">,</span> <span class="n">view2_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>

        <span class="n">View1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">view1_class0</span><span class="p">,</span> <span class="n">view1_class1</span><span class="p">))</span>
        <span class="n">View2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">view2_class0</span><span class="p">,</span> <span class="n">view2_class1</span><span class="p">))</span>
        <span class="n">Labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">(</span>
            <span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">N_per_class</span><span class="p">,),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_per_class</span><span class="p">,)))</span>

        <span class="c1"># Split both views into testing and training</span>
        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
            <span class="n">train_test_split</span><span class="p">(</span><span class="n">View1</span><span class="p">,</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">View2_train</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
            <span class="n">train_test_split</span><span class="p">(</span><span class="n">View2</span><span class="p">,</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

        <span class="n">labels_train</span> <span class="o">=</span> <span class="n">labels_train_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">labels_test</span> <span class="o">=</span> <span class="n">labels_test_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Add the perfect examples</span>
        <span class="n">View1_train</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
            <span class="p">(</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">perfect_class0_v1</span><span class="p">,</span> <span class="n">perfect_class1_v1</span><span class="p">))</span>
        <span class="n">View2_train</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
            <span class="p">(</span><span class="n">View2_train</span><span class="p">,</span> <span class="n">perfect_class0_v2</span><span class="p">,</span> <span class="n">perfect_class1_v2</span><span class="p">))</span>
        <span class="n">labels_train</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">labels_train</span><span class="p">,</span> <span class="n">perfect_labels</span><span class="p">))</span>

        <span class="c1"># randomly remove all but perfect labeled samples</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">num_perfect</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">num_perfect</span><span class="p">):</span>
            <span class="n">remove_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span>
                                <span class="n">num_perfect</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">))</span>

        <span class="c1"># make sure both classes have at least 1 labeled example</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span>
                                <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">)</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="c1"># Only once, since not affected by &quot;num iters&quot;</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span> <span class="o">=</span> \
                <span class="n">single_view_class</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">],</span>
                                  <span class="n">View1_test</span><span class="p">,</span>
                                  <span class="n">labels_test</span><span class="p">,</span>
                                  <span class="n">View2_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">View2_test</span><span class="p">,</span>
                                  <span class="n">view2_solver</span><span class="p">,</span>
                                  <span class="n">view2_penalty</span><span class="p">)</span>
            <span class="n">acc_view1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view1</span><span class="p">)</span>
            <span class="n">acc_view2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view2</span><span class="p">)</span>
            <span class="n">acc_combined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_combined</span><span class="p">)</span>

        <span class="c1"># Multiview</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">view2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">view2_penalty</span><span class="p">)</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">(</span><span class="n">gnb0</span><span class="p">,</span> <span class="n">gnb1</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="n">iters</span><span class="p">)</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">)))</span>

<span class="n">acc_view1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view1</span><span class="p">)</span>
<span class="n">acc_view2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view2</span><span class="p">)</span>
<span class="n">acc_combined</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_combined</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">acc_ct</span><span class="p">]</span>


<span class="c1"># make a figure from the data</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view1</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_combined</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_ct</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s1">&#39;View 1&#39;</span><span class="p">,</span> <span class="s1">&#39;View 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Concatenated&#39;</span><span class="p">,</span> <span class="s1">&#39;multiview&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy Over </span><span class="si">{}</span><span class="s2"> Randomizations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randomizations</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Iterations of Co-Training&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;When Labeled Data is Extremely Clean</span><span class="se">\n</span><span class="s1">CoTraining Outperforms </span><span class="se">\</span>
<span class="s1">    Single Views</span><span class="se">\n</span><span class="s1">but Naive Concatenation Performs Better&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-when-labeled-data-is-not-very-separable">
<h2>Performance when labeled data is not very separable<a class="headerlink" href="#performance-when-labeled-data-is-not-very-separable" title="Permalink to this headline">¶</a></h2>
<p>Here, the 2 class distributions are the following
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [1, 1]
- Class 1 covariance: .2*eye(2)</p>
<p>Labeled examples are chosen to be far from their respective means according
to a uniform distribution in 2 dimensions between .2 and .75 away from the x1
or x2 coordinate of the mean</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomizations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_per_class</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">num_perfect</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">uniform_min</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">uniform_max</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">view2_penalty</span> <span class="o">=</span> <span class="s1">&#39;l1&#39;</span>
<span class="n">view2_solver</span> <span class="o">=</span> <span class="s1">&#39;liblinear&#39;</span>

<span class="n">N_iters</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">N_iters</span><span class="p">]</span>
<span class="n">acc_view1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_view2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_combined</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_iters</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomizations</span><span class="p">):</span>

        <span class="c1"># Create Data</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="n">view1_mu0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view1_mu1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view1_cov</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">view2_mu0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view2_mu1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
        <span class="n">view2_cov</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.eye.html#numpy.eye" title="numpy.eye" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># generage bad examples</span>
        <span class="n">perfect_class0_v1</span> <span class="o">=</span> <span class="n">view1_mu0</span> <span class="o">+</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">perfect_class0_v2</span> <span class="o">=</span> <span class="n">view1_mu0</span> <span class="o">+</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">perfect_class1_v1</span> <span class="o">=</span> <span class="n">view1_mu1</span> <span class="o">-</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">perfect_class1_v2</span> <span class="o">=</span> <span class="n">view1_mu1</span> <span class="o">-</span> \
            <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_perfect</span><span class="p">):</span>
            <span class="n">perfect_class0_v1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class0_v1</span><span class="p">,</span> <span class="n">view1_mu0</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span>
                    <span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
            <span class="n">perfect_class0_v2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class0_v2</span><span class="p">,</span> <span class="n">view1_mu0</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span>
                    <span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
            <span class="n">perfect_class1_v1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class1_v1</span><span class="p">,</span> <span class="n">view1_mu1</span> <span class="o">-</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span>
                    <span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
            <span class="n">perfect_class1_v2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
                <span class="p">(</span><span class="n">perfect_class1_v2</span><span class="p">,</span> <span class="n">view1_mu1</span> <span class="o">-</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span>
                    <span class="n">uniform_min</span><span class="p">,</span> <span class="n">uniform_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">view1_mu0</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
        <span class="n">perfect_labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">num_perfect</span><span class="p">,)</span>
        <span class="n">perfect_labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span>
            <span class="n">perfect_labels</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">num_perfect</span><span class="p">,)))</span>

        <span class="n">view1_class0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view1_mu0</span><span class="p">,</span> <span class="n">view1_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>
        <span class="n">view1_class1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view1_mu1</span><span class="p">,</span> <span class="n">view1_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>

        <span class="n">view2_class0</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view2_mu0</span><span class="p">,</span> <span class="n">view2_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>
        <span class="n">view2_class1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.multivariate_normal.html#numpy.random.multivariate_normal" title="numpy.random.multivariate_normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span></a><span class="p">(</span>
            <span class="n">view2_mu1</span><span class="p">,</span> <span class="n">view2_cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_per_class</span><span class="p">)</span>

        <span class="n">View1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">view1_class0</span><span class="p">,</span> <span class="n">view1_class1</span><span class="p">))</span>
        <span class="n">View2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">view2_class0</span><span class="p">,</span> <span class="n">view2_class1</span><span class="p">))</span>
        <span class="n">Labels</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="n">N_per_class</span><span class="p">,),</span>
                                 <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_per_class</span><span class="p">,)))</span>

        <span class="c1"># Split both views into testing and training</span>
        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
            <span class="n">train_test_split</span><span class="p">(</span><span class="n">View1</span><span class="p">,</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">View2_train</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
            <span class="n">train_test_split</span><span class="p">(</span><span class="n">View2</span><span class="p">,</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

        <span class="n">labels_train</span> <span class="o">=</span> <span class="n">labels_train_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">labels_test</span> <span class="o">=</span> <span class="n">labels_test_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Add the perfect examples</span>
        <span class="n">View1_train</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
            <span class="p">(</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">perfect_class0_v1</span><span class="p">,</span> <span class="n">perfect_class1_v1</span><span class="p">))</span>
        <span class="n">View2_train</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html#numpy.vstack" title="numpy.vstack" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">vstack</span></a><span class="p">(</span>
            <span class="p">(</span><span class="n">View2_train</span><span class="p">,</span> <span class="n">perfect_class0_v2</span><span class="p">,</span> <span class="n">perfect_class1_v2</span><span class="p">))</span>
        <span class="n">labels_train</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html#numpy.concatenate" title="numpy.concatenate" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">((</span><span class="n">labels_train</span><span class="p">,</span> <span class="n">perfect_labels</span><span class="p">))</span>

        <span class="c1"># randomly remove all but perfect labeled samples</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">num_perfect</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">num_perfect</span><span class="p">):</span>
            <span class="n">remove_idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span>
                                <span class="n">num_perfect</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">))</span>

        <span class="c1"># make sure both classes have at least 1 labeled example</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span>
                                <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">)</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="c1"># Only once, since not affected by &quot;num iters&quot;</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span> <span class="o">=</span> \
                <span class="n">single_view_class</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">],</span>
                                  <span class="n">View1_test</span><span class="p">,</span>
                                  <span class="n">labels_test</span><span class="p">,</span>
                                  <span class="n">View2_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">View2_test</span><span class="p">,</span>
                                  <span class="n">view2_solver</span><span class="p">,</span>
                                  <span class="n">view2_penalty</span><span class="p">)</span>
            <span class="n">acc_view1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view1</span><span class="p">)</span>
            <span class="n">acc_view2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view2</span><span class="p">)</span>
            <span class="n">acc_combined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_combined</span><span class="p">)</span>

        <span class="c1"># Multiview</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">view2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">view2_penalty</span><span class="p">)</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">(</span><span class="n">gnb0</span><span class="p">,</span> <span class="n">gnb1</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="n">iters</span><span class="p">)</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">)))</span>


<span class="n">acc_view1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view1</span><span class="p">)</span>
<span class="n">acc_view2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view2</span><span class="p">)</span>
<span class="n">acc_combined</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_combined</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">acc_ct</span><span class="p">]</span>


<span class="c1"># make a figure from the data</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view1</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_combined</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_ct</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s1">&#39;View 1&#39;</span><span class="p">,</span> <span class="s1">&#39;View 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Concatenated&#39;</span><span class="p">,</span> <span class="s1">&#39;multiview&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy Over </span><span class="si">{}</span><span class="s2"> Randomizations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randomizations</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Iterations of Co-Training&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span>
    <span class="s1">&#39;When Labeled Examples are Not Representative</span><span class="se">\n\</span>
<span class="s1">        CoTraining Does Poorly, as Expected&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-when-data-is-overlapping">
<h2>Performance when data is overlapping<a class="headerlink" href="#performance-when-data-is-overlapping" title="Permalink to this headline">¶</a></h2>
<p>Here, the 2 class distributions are the following
- Class 0 mean: [0, 0]
- Class 0 covariance: .2*eye(2)
- Class 1 mean: [0, 0]
- Class 1 covariance: .2*eye(2)</p>
<p>Labeled examples are chosen randomly from the training set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">randomizations</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_per_class</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">view2_penalty</span> <span class="o">=</span> <span class="s1">&#39;l1&#39;</span>
<span class="n">view2_solver</span> <span class="o">=</span> <span class="s1">&#39;liblinear&#39;</span>
<span class="n">class2_mean_center</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 1 would make this identical to first test</span>

<span class="n">N_iters</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">N_iters</span><span class="p">]</span>
<span class="n">acc_view1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_view2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_combined</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N_iters</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomizations</span><span class="p">):</span>

        <span class="c1"># Create Data</span>
        <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span>\
            <span class="n">View2_test</span><span class="p">,</span> <span class="n">labels_test</span> <span class="o">=</span> <span class="n">create_data</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">N_per_class</span><span class="p">,</span>
                                                  <span class="n">class2_mean_center</span><span class="p">)</span>

        <span class="c1"># randomly remove some labels</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">),)</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">99</span>
        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># make sure both classes have at least 1 labeled example</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">scatterplot_classes</span><span class="p">(</span><span class="n">not_removed</span><span class="p">,</span> <span class="n">labels_train</span><span class="p">,</span>
                                <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">)</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="c1"># Only once, since not affected by &quot;num iters&quot;</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy_view1</span><span class="p">,</span> <span class="n">accuracy_view2</span><span class="p">,</span> <span class="n">accuracy_combined</span> <span class="o">=</span> \
                <span class="n">single_view_class</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">],</span>
                                  <span class="n">View1_test</span><span class="p">,</span>
                                  <span class="n">labels_test</span><span class="p">,</span>
                                  <span class="n">View2_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                                  <span class="n">View2_test</span><span class="p">,</span>
                                  <span class="n">view2_solver</span><span class="p">,</span>
                                  <span class="n">view2_penalty</span><span class="p">)</span>
            <span class="n">acc_view1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view1</span><span class="p">)</span>
            <span class="n">acc_view2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_view2</span><span class="p">)</span>
            <span class="n">acc_combined</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_combined</span><span class="p">)</span>

        <span class="c1"># Multiview</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">view2_solver</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="n">view2_penalty</span><span class="p">)</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">(</span><span class="n">gnb0</span><span class="p">,</span> <span class="n">gnb1</span><span class="p">,</span> <span class="n">num_iter</span><span class="o">=</span><span class="n">iters</span><span class="p">)</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View1_train</span><span class="p">,</span> <span class="n">View2_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View1_test</span><span class="p">,</span> <span class="n">View2_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="p">[</span><span class="n">count</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">)))</span>

<span class="n">acc_view1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view1</span><span class="p">)</span>
<span class="n">acc_view2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_view2</span><span class="p">)</span>
<span class="n">acc_combined</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_combined</span><span class="p">)</span>
<span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">acc_ct</span><span class="p">]</span>


<span class="c1"># make a figure from the data</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view1</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_view2</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_combined</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N_iters</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_iters</span><span class="p">,</span> <span class="n">acc_ct</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s1">&#39;View 1&#39;</span><span class="p">,</span> <span class="s1">&#39;View 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Concatenated&#39;</span><span class="p">,</span> <span class="s1">&#39;multiview&#39;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy Over </span><span class="si">{}</span><span class="s2"> Randomizations&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randomizations</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Iterations of Co-Training&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;When Both Views Have Overlapping Data</span><span class="se">\n\</span>
<span class="s1">    CoTraining Performs with Chance, as Expected&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="performance-as-labeled-data-proportion-essentially-sample-size-is-varied">
<h2>Performance as labeled data proportion (essentially sample size) is varied<a class="headerlink" href="#performance-as-labeled-data-proportion-essentially-sample-size-is-varied" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <a href="../../references/datasets.html#mvlearn.datasets.load_UCImultifeature" title="mvlearn.datasets.load_UCImultifeature" class="sphx-glr-backref-module-mvlearn-datasets sphx-glr-backref-type-py-function"><span class="n">load_UCImultifeature</span></a><span class="p">(</span><span class="n">select_labeled</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Use only the first 2 views as an example</span>
<span class="n">View0</span><span class="p">,</span> <span class="n">View1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Split both views into testing and training</span>
<span class="n">View0_train</span><span class="p">,</span> <span class="n">View0_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
    <span class="n">train_test_split</span><span class="p">(</span><span class="n">View0</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">View1_train</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
    <span class="n">train_test_split</span><span class="p">(</span><span class="n">View1</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Do PCA to visualize data</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">View0_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">View0_train</span><span class="p">)</span>
<span class="n">View1_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">View1_train</span><span class="p">)</span>

<span class="n">View0_pca_class0</span> <span class="o">=</span> <span class="n">View0_pca</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train_full</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>
<span class="n">View0_pca_class1</span> <span class="o">=</span> <span class="n">View0_pca</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train_full</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>
<span class="n">View1_pca_class0</span> <span class="o">=</span> <span class="n">View1_pca</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train_full</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>
<span class="n">View1_pca_class1</span> <span class="o">=</span> <span class="n">View1_pca</span><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="n">labels_train_full</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:]</span>

<span class="c1"># plot the views</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View0_pca_class0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View0_pca_class0</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View0_pca_class1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View0_pca_class1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;2 Component PCA of Full View 1 (Fourier Coefficients) Training Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View1_pca_class0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View1_pca_class0</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">View1_pca_class1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">View1_pca_class1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
    <span class="s1">&#39;2 Component PCA of Full View 2 (Profile Correlations) Training Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">))</span>

<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>


<span class="n">N_labeled_full</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_ct_full</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_v0_full</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">acc_v1_full</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">iters</span> <span class="o">=</span> <span class="mi">500</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span> <span class="o">.</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                  <a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)):</span>

    <span class="n">N_labeled</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">acc_ct</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">acc_v0</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">acc_v1</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">View0_train</span><span class="p">,</span> <span class="n">View0_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
        <span class="n">train_test_split</span><span class="p">(</span><span class="n">View0</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">View1_train</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">,</span> <span class="n">labels_train_full</span><span class="p">,</span> <span class="n">labels_test_full</span> <span class="o">=</span> \
        <span class="n">train_test_split</span><span class="p">(</span><span class="n">View1</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">):</span>

        <span class="n">labels_train</span> <span class="o">=</span> <span class="n">labels_train_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">labels_test</span> <span class="o">=</span> <span class="n">labels_test_full</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Randomly remove all but a small percentage of the labels</span>
        <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># 6</span>
        <span class="n">remove_idx</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">),)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">-</span><span class="n">i</span>
        <span class="n">labels_train</span><span class="p">[</span><span class="n">remove_idx</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="numpy.nan" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a>
        <span class="n">not_removed</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.where.html#numpy.where" title="numpy.where" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">where</span></a><span class="p">(</span><span class="o">~</span><span class="n">remove_idx</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">not_removed</span> <span class="o">=</span> <span class="n">not_removed</span><span class="p">[:</span><span class="n">num</span><span class="p">]</span>
        <span class="n">N_labeled</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">labels_train</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Single view semi-supervised learning</span>
        <span class="n">gnb0</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
        <span class="n">gnb1</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

        <span class="c1"># Train on only the examples with labels</span>
        <span class="n">gnb0</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">View0_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                 <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">])</span>

        <span class="n">y_pred0</span> <span class="o">=</span> <span class="n">gnb0</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">View0_test</span><span class="p">)</span>
        <span class="n">gnb1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">View1_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
                 <span class="n">labels_train</span><span class="p">[</span><span class="n">not_removed</span><span class="p">])</span>
        <span class="n">y_pred1</span> <span class="o">=</span> <span class="n">gnb1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">View1_test</span><span class="p">)</span>

        <span class="n">acc_v0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred0</span><span class="p">))</span>
        <span class="n">acc_v1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred1</span><span class="p">))</span>

        <span class="c1"># Multi-view co-training semi-supervised learning</span>
        <span class="c1"># Train a CTClassifier on all the labeled and unlabeled training data</span>
        <span class="n">ctc</span> <span class="o">=</span> <a href="../../references/semi_supervised.html#mvlearn.semi_supervised.CTClassifier" title="mvlearn.semi_supervised.CTClassifier" class="sphx-glr-backref-module-mvlearn-semi_supervised sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">CTClassifier</span></a><span class="p">()</span>
        <span class="n">ctc</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">View0_train</span><span class="p">,</span> <span class="n">View1_train</span><span class="p">],</span> <span class="n">labels_train</span><span class="p">)</span>
        <span class="n">y_pred_ct</span> <span class="o">=</span> <span class="n">ctc</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">View0_test</span><span class="p">,</span> <span class="n">View1_test</span><span class="p">])</span>
        <span class="n">acc_ct</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">labels_test</span><span class="p">,</span> <span class="n">y_pred_ct</span><span class="p">))</span>

    <span class="n">acc_ct_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_ct</span><span class="p">))</span>
    <span class="n">acc_v0_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_v0</span><span class="p">))</span>
    <span class="n">acc_v1_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">acc_v1</span><span class="p">))</span>
    <span class="n">N_labeled_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><span class="n">N_labeled</span><span class="p">))</span>


<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>

<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_labeled_full</span><span class="p">,</span> <span class="n">acc_v0_full</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_labeled_full</span><span class="p">,</span> <span class="n">acc_v1_full</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">N_labeled_full</span><span class="p">,</span> <span class="n">acc_ct_full</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">((</span><span class="s2">&quot;Fourier Coefficients Only:</span><span class="se">\n</span><span class="s2">sklearn Gaussian Naive Bayes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Profile Correlations Only:</span><span class="se">\n</span><span class="s2">sklearn Gaussian Naive Bayes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Using Both Views:</span><span class="se">\n</span><span class="s2">multiview CTClassifier (default)&quot;</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span>
    <span class="s2">&quot;Semi-Supervised Classification Accuracy with</span><span class="se">\n\</span>
<span class="s2">        CTClassifier (default Naive Bayes)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s2">&quot;Labeled Data Proportion&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Average Accuracy on Test Data: </span><span class="si">{}</span><span class="s2"> Trials&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iters</span><span class="p">))</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-semi-supervised-cotraining-classification-simulatedperformance-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<a class="reference download internal" download="" href="../../_downloads/e48ecefdf559c5fc94c7af7b751f2d89/cotraining_classification_simulatedperformance.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">cotraining_classification_simulatedperformance.py</span></code></a></div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<a class="reference download internal" download="" href="../../_downloads/8cfbc938e82e21e62dfc699aaeee7924/cotraining_classification_simulatedperformance.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">cotraining_classification_simulatedperformance.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../references/index.html" class="btn btn-neutral float-right" title="Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_cotraining_classification.html" class="btn btn-neutral" title="2-View Semi-Supervised Classification" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<p style="text-align: center; margin: .5rem;">
    <a href="https://www.netlify.com">
        <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" />
    </a>
</p>
 


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>